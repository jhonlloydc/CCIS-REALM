<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="css/main.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    </head>
    <title>CCIS</title>
    <body>
        <div class="side-box">
            <div class="action-box">
                <div id='chat'>
                    <div class="online"></div>Chat</div>
                <div class="close">X</div>
            </div>
            
            <div class="chat-content">
                <div class="chats">
                    
                </div>
                <div class="message-box">
                    <textarea maxlength='45' class="input-msg" placeholder="Send Message"></textarea>
                    <button id='send'>Send</button>
                </div>
            </div>
            
        </div>
        
        <h1 class="page-header"></h1>
        <div class="nav-bar">
            <button id="menu-1">Menu 1</button>
            <button id="menu-2">Menu 2</button>
            <button id='menu-3'>Menu 1</button>
            <button id='menu-4' style="margin-right: 30px;">Menu 1</button>
        </div>
        <div class="main-content">
            <iframe id='content' src="page1.html" frameborder="0"></iframe>
            
        </div>
        
    </body>
    <script src="js/config.js"></script>
    <script>

        // ON LOAD
        let currentDate = new Date();
        let cDay = currentDate.getDate();
        let cMonth = currentDate.getMonth() + 1;
        let cYear = currentDate.getFullYear();
        let date = "<b>" + cDay + "/" + cMonth + "/" + cYear + "</b>";
        $('#menu-1').css({ "border-bottom": "solid 2px","border-color": "black", "background-color":"#0057FF","color":"white"});

        $('#send').click(function(){

            var name = "Anonymous";
            var message = $('.input-msg').val();
            
            $.post("https://pasuyo.store/ccis/ccis-add-message?name="+name+"&message="+message+"&date="+date+"");

            $('.input-msg').val('');
        });


        $.getJSON(
                "https://pasuyo.store/ccis/ccis-chat-api",function(data){
                    $('.chats').html('');
                    $.each(data,function(key,value){


                        $('.chats').append(

                            "<div class='p-chat'>"+
                                "<label class='sender'>"+value.name+"</label>"+
                                "<p class='m-message'>"+value.message+"</p>"+
                            "</div>"
                        );


                    });
                });

        setInterval(() => {

            $.getJSON(
                "https://pasuyo.store/ccis/ccis-chat-api",function(data){
                    $('.chats').html('');
                    $.each(data,function(key,value){


                        $('.chats').append(

                            "<div class='p-chat'>"+
                                "<label class='sender'>"+value.name+"</label>"+
                                "<p class='m-message'>"+value.message+"</p>"+
                                "<label class='date'>"+value.date+"</label>"+
                            "</div>"
                        );


                    });
                });

        }, 500);


        $('#chat').click(function(){
            $('.side-box').css({"height":"500px","display":"block"});
            $('.chat-content').css({"display":"flex"});
        });
        $('.close').click(function(){
            $('.chat-content').css({"display":"none"});
            $('.side-box').css({"height":"50px"});
            
        });



        $('button').click(function(){
            $('button').css({ "border-bottom": "none","border-color": "none", "background-color":"#E7E7E7","color":"white"});
            $(this).css({ "border-bottom": "solid 2px","border-color": "black", "background-color":"#0057FF","color":"white"});
        });
        $('.page-header').html(pageheader);
        $('#menu-1').click(function(){
           

            $('.main-content').html('');
            $('.main-content').append(
                "<iframe id='content' src='page1.html' frameborder='0'></iframe>"
            );
        });
        $('#menu-2').click(function(){
            

            $('.main-content').html('');
            $('.main-content').append(
                "<iframe id='content' src='page2.html' frameborder='0'></iframe>"
            );

        });
    </script>
    
</html>